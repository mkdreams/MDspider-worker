!function n(o,i,s){function a(r,e){if(!i[r]){if(!o[r]){var t="function"==typeof require&&require;if(!e&&t)return t(r,!0);if(c)return c(r,!0);throw(e=new Error("Cannot find module '"+r+"'")).code="MODULE_NOT_FOUND",e}t=i[r]={exports:{}},o[r][0].call(t.exports,function(e){return a(o[r][1][e]||e)},t,t.exports,n,o,i,s)}return i[r].exports}for(var c="function"==typeof require&&require,e=0;e<s.length;e++)a(s[e]);return a}({1:[function(e,r,t){var n,o,r=r.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{o="function"==typeof clearTimeout?clearTimeout:s}catch(e){o=s}function a(r){if(n===setTimeout)return setTimeout(r,0);if((n===i||!n)&&setTimeout)return(n=setTimeout)(r,0);try{return n(r,0)}catch(e){try{return n.call(null,r,0)}catch(e){return n.call(this,r,0)}}}var c,u=[],l=!1,h=-1;function p(){l&&c&&(l=!1,c.length?u=c.concat(u):h=-1,u.length&&_())}function _(){if(!l){for(var e=a(p),r=(l=!0,u.length);r;){for(c=u,u=[];++h<r;)c&&c[h].run();h=-1,r=u.length}c=null,l=!1,!function(r){if(o===clearTimeout)return clearTimeout(r);if((o===s||!o)&&clearTimeout)return(o=clearTimeout)(r);try{o(r)}catch(e){try{return o.call(null,r)}catch(e){return o.call(this,r)}}}(e)}}function f(e,r){this.fun=e,this.array=r}function d(){}r.nextTick=function(e){var r=new Array(arguments.length-1);if(1<arguments.length)for(var t=1;t<arguments.length;t++)r[t-1]=arguments[t];u.push(new f(e,r)),1!==u.length||l||a(_)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=d,r.addListener=d,r.once=d,r.off=d,r.removeListener=d,r.removeAllListeners=d,r.emit=d,r.prependListener=d,r.prependOnceListener=d,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},{}],2:[function(e,r,t){"use strict";e=e("./wampy.js");window.Wampy=e.Wampy},{"./wampy.js":7}],3:[function(e,r,n){!function(t){!function(){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.isNode=n.WAMP_MSG_SPEC=n.WAMP_ERROR_MSG=n.SUCCESS=n.E2EE_SERIALIZERS=void 0;n.WAMP_MSG_SPEC={HELLO:1,WELCOME:2,ABORT:3,CHALLENGE:4,AUTHENTICATE:5,GOODBYE:6,ERROR:8,PUBLISH:16,PUBLISHED:17,SUBSCRIBE:32,SUBSCRIBED:33,UNSUBSCRIBE:34,UNSUBSCRIBED:35,EVENT:36,CALL:48,CANCEL:49,RESULT:50,REGISTER:64,REGISTERED:65,UNREGISTER:66,UNREGISTERED:67,INVOCATION:68,INTERRUPT:69,YIELD:70},n.SUCCESS={code:0,error:null},n.WAMP_ERROR_MSG={SUCCESS:"Success!",URI_ERROR:"Topic URI doesn't meet requirements!",NO_BROKER:"Server doesn't provide broker role!",NO_CALLBACK_SPEC:"No required callback function specified!",INVALID_PARAM:"Invalid parameter(s) specified!",NO_SERIALIZER_AVAILABLE:"Server has chosen a serializer, which is not available!",NON_EXIST_UNSUBSCRIBE:"Trying to unsubscribe from non existent subscription!",NO_DEALER:"Server doesn't provide dealer role!",RPC_ALREADY_REGISTERED:"RPC already registered!",NON_EXIST_RPC_UNREG:"Received rpc unregistration for non existent rpc!",NON_EXIST_RPC_INVOCATION:"Received invocation for non existent rpc!",NON_EXIST_RPC_REQ_ID:"No RPC calls in action with specified request ID!",NO_REALM:"No realm specified!",NO_WS_OR_URL:"No websocket provided or URL specified is incorrect!",NO_CRA_CB_OR_ID:"No onChallenge callback or authid was provided for authentication!",CHALLENGE_EXCEPTION:"Exception raised during challenge processing",PPT_NOT_SUPPORTED:"Payload Passthru Mode is not supported by the router",PPT_INVALID_SCHEME:"Provided PPT scheme is invalid",PPT_SRLZ_INVALID:"Provided PPT serializer is invalid or not supported",PPT_SRLZ_ERR:"Can not serialize/deserialize payload",PROTOCOL_VIOLATION:"Protocol violation",WAMP_ABORT:"Router aborted connection",WAMP_GENERAL_ERROR:"Wamp error",WEBSOCKET_ERROR:"Websocket error",FEATURE_NOT_SUPPORTED:"Feature not supported"};n.E2EE_SERIALIZERS=["cbor"];var e="object"===(void 0===t?"undefined":r(t))&&"[object process]"===Object.prototype.toString.call(t);n.isNode=e}.call(this)}.call(this,e("_process"))},{_process:1}],4:[function(e,r,t){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.WebsocketError=t.WampError=t.UriError=t.UnsubscribeError=t.UnregisterError=t.SubscribeError=t.RegisterError=t.RPCAlreadyRegisteredError=t.PublishError=t.ProtocolViolationError=t.PPTSerializerInvalidError=t.PPTSerializationError=t.PPTNotSupportedError=t.PPTInvalidSchemeError=t.NonExistUnsubscribeError=t.NonExistRPCUnregistrationError=t.NonExistRPCReqIdError=t.NoWsOrUrlError=t.NoSerializerAvailableError=t.NoRealmError=t.NoDealerError=t.NoCallbackError=t.NoCRACallbackOrIdError=t.NoBrokerError=t.InvalidParamError=t.FeatureNotSupportedError=t.ChallengeExceptionError=t.CallError=t.AbortError=void 0;var a=e("./constants.js");function n(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,r){if("object"!==o(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0===t)return("string"===r?String:Number)(e);t=t.call(e,r||"default");if("object"!==o(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===o(e)?e:String(e)}(n.key),n)}}function c(e,r,t){return r&&n(e.prototype,r),t&&n(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function l(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&_(e,r)}function h(t){var n=s();return function(){var e,r=f(t),r=(e=n?(e=f(this).constructor,Reflect.construct(r,arguments,e)):r.apply(this,arguments),this);if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==r)return r;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function p(e){var t="function"==typeof Map?new Map:void 0;return(p=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return i(e,arguments,f(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_(r,e)})(e)}function i(e,r,t){return(i=s()?Reflect.construct.bind():function(e,r,t){var n=[null];n.push.apply(n,r);r=new(Function.bind.apply(e,n));return t&&_(r,t.prototype),r}).apply(null,arguments)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function _(e,r){return(_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,r){return e.__proto__=r,e})(e,r)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var e=function(){l(t,p(Error));var r=h(t);function t(){var e;return u(this,t),(e=r.call(this,a.WAMP_ERROR_MSG.URI_ERROR)).name="UriError",e.code=1,e}return c(t)}(),e=(t.UriError=e,function(){l(t,p(Error));var r=h(t);function t(){var e;return u(this,t),(e=r.call(this,a.WAMP_ERROR_MSG.NO_BROKER)).name="NoBrokerError",e.code=2,e}return c(t)}()),e=(t.NoBrokerError=e,function(){l(t,p(Error));var r=h(t);function t(){var e;return u(this,t),(e=r.call(this,a.WAMP_ERROR_MSG.NO_CALLBACK_SPEC)).name="NoCallbackError",e.code=3,e}return c(t)}()),e=(t.NoCallbackError=e,function(){l(n,p(Error));var t=h(n);function n(e){var r;return u(this,n),(r=t.call(this,a.WAMP_ERROR_MSG.INVALID_PARAM)).name="InvalidParamError",r.code=4,r.parameter=e,r}return c(n)}()),e=(t.InvalidParamError=e,function(){l(t,p(Error));var r=h(t);function t(){var e;return u(this,t),(e=r.call(this,a.WAMP_ERROR_MSG.NO_SERIALIZER_AVAILABLE)).name="NoSerializerAvailableError",e.code=6,e}return c(t)}()),e=(t.NoSerializerAvailableError=e,function(){l(t,p(Error));var r=h(t);function t(){var e;return u(this,t),(e=r.call(this,a.WAMP_ERROR_MSG.NON_EXIST_UNSUBSCRIBE)).name="NonExistUnsubscribeError",e.code=7,e}return c(t)}()),e=(t.NonExistUnsubscribeError=e,function(){l(t,p(Error));var r=h(t);function t(){var e;return u(this,t),(e=r.call(this,a.WAMP_ERROR_MSG.NO_DEALER)).name="NoDealerError",e.code=12,e}return c(t)}()),e=(t.NoDealerError=e,function(){l(t,p(Error));var r=h(t);function t(){var e;return u(this,t),(e=r.call(this,a.WAMP_ERROR_MSG.RPC_ALREADY_REGISTERED)).name="RPCAlreadyRegisteredError",e.code=15,e}return c(t)}()),e=(t.RPCAlreadyRegisteredError=e,function(){l(t,p(Error));var r=h(t);function t(){var e;return u(this,t),(e=r.call(this,a.WAMP_ERROR_MSG.NON_EXIST_RPC_UNREG)).name="NonExistRPCUnregistrationError",e.code=17,e}return c(t)}()),e=(t.NonExistRPCUnregistrationError=e,function(){l(t,p(Error));var r=h(t);function t(){var e;return u(this,t),(e=r.call(this,a.WAMP_ERROR_MSG.NON_EXIST_RPC_REQ_ID)).name="NonExistRPCReqIdError",e.code=20,e}return c(t)}()),e=(t.NonExistRPCReqIdError=e,function(){l(t,p(Error));var r=h(t);function t(){var e;return u(this,t),(e=r.call(this,a.WAMP_ERROR_MSG.NO_REALM)).name="NoRealmError",e.code=21,e}return c(t)}()),e=(t.NoRealmError=e,function(){l(t,p(Error));var r=h(t);function t(){var e;return u(this,t),(e=r.call(this,a.WAMP_ERROR_MSG.NO_WS_OR_URL)).name="NoWsOrUrlError",e.code=22,e}return c(t)}()),e=(t.NoWsOrUrlError=e,function(){l(t,p(Error));var r=h(t);function t(){var e;return u(this,t),(e=r.call(this,a.WAMP_ERROR_MSG.NO_CRA_CB_OR_ID)).name="NoCRACallbackOrIdError",e.code=23,e.errorUri="wamp.error.cannot_authenticate",e}return c(t)}()),e=(t.NoCRACallbackOrIdError=e,function(){l(t,p(Error));var r=h(t);function t(){var e;return u(this,t),(e=r.call(this,a.WAMP_ERROR_MSG.CHALLENGE_EXCEPTION)).name="ChallengeExceptionError",e.code=24,e.errorUri="wamp.error.cannot_authenticate",e}return c(t)}()),e=(t.ChallengeExceptionError=e,function(){l(t,p(Error));var r=h(t);function t(){var e;return u(this,t),(e=r.call(this,a.WAMP_ERROR_MSG.PPT_NOT_SUPPORTED)).name="PPTNotSupportedError",e.code=25,e}return c(t)}()),e=(t.PPTNotSupportedError=e,function(){l(t,p(Error));var r=h(t);function t(){var e;return u(this,t),(e=r.call(this,a.WAMP_ERROR_MSG.PPT_INVALID_SCHEME)).name="PPTInvalidSchemeError",e.code=26,e}return c(t)}()),e=(t.PPTInvalidSchemeError=e,function(){l(t,p(Error));var r=h(t);function t(){var e;return u(this,t),(e=r.call(this,a.WAMP_ERROR_MSG.PPT_SRLZ_INVALID)).name="PPTSerializerInvalidError",e.code=27,e}return c(t)}()),e=(t.PPTSerializerInvalidError=e,function(){l(t,p(Error));var r=h(t);function t(){var e;return u(this,t),(e=r.call(this,a.WAMP_ERROR_MSG.PPT_SRLZ_ERR)).name="PPTSerializationError",e.code=28,e}return c(t)}()),e=(t.PPTSerializationError=e,function(){l(n,p(Error));var t=h(n);function n(e,r){return u(this,n),(r=t.call(this,r||a.WAMP_ERROR_MSG.PROTOCOL_VIOLATION)).name="ProtocolViolationError",r.code=29,r.errorUri=e,r}return c(n)}()),e=(t.ProtocolViolationError=e,function(){l(o,p(Error));var n=h(o);function o(e){var r,t=e.error,e=e.details;return u(this,o),(r=n.call(this,a.WAMP_ERROR_MSG.WAMP_ABORT)).name="AbortedError",r.code=30,r.errorUri=t,r.details=e,r}return c(o)}()),d=(t.AbortError=e,function(){l(s,p(Error));var i=h(s);function s(e){var r,t=e.error,n=e.details,o=e.argsList,e=e.argsDict;return u(this,s),(r=i.call(this,a.WAMP_ERROR_MSG.WAMP_GENERAL_ERROR)).name="WampError",r.code=31,r.errorUri=t,r.details=n,r.argsList=o,r.argsDict=e,r}return c(s)}()),e=(t.WampError=d,function(){l(i,d);var o=h(i);function i(e){var r=e.error,t=e.details,n=e.argsList,e=e.argsDict;return u(this,i),(r=o.call(this,{error:r,details:t,argsList:n,argsDict:e})).name="SubscribeError",r.code=32,r}return c(i)}()),e=(t.SubscribeError=e,function(){l(i,d);var o=h(i);function i(e){var r=e.error,t=e.details,n=e.argsList,e=e.argsDict;return u(this,i),(r=o.call(this,{error:r,details:t,argsList:n,argsDict:e})).name="UnsubscribeError",r.code=33,r}return c(i)}()),e=(t.UnsubscribeError=e,function(){l(i,d);var o=h(i);function i(e){var r=e.error,t=e.details,n=e.argsList,e=e.argsDict;return u(this,i),(r=o.call(this,{error:r,details:t,argsList:n,argsDict:e})).name="PublishError",r.code=34,r}return c(i)}()),e=(t.PublishError=e,function(){l(i,d);var o=h(i);function i(e){var r=e.error,t=e.details,n=e.argsList,e=e.argsDict;return u(this,i),(r=o.call(this,{error:r,details:t,argsList:n,argsDict:e})).name="RegisterError",r.code=35,r}return c(i)}()),e=(t.RegisterError=e,function(){l(i,d);var o=h(i);function i(e){var r=e.error,t=e.details,n=e.argsList,e=e.argsDict;return u(this,i),(r=o.call(this,{error:r,details:t,argsList:n,argsDict:e})).name="UnregisterError",r.code=36,r}return c(i)}()),e=(t.UnregisterError=e,function(){l(i,d);var o=h(i);function i(e){var r=e.error,t=e.details,n=e.argsList,e=e.argsDict;return u(this,i),(r=o.call(this,{error:r,details:t,argsList:n,argsDict:e})).name="CallError",r.code=37,r}return c(i)}()),e=(t.CallError=e,function(){l(n,p(Error));var t=h(n);function n(e){var r;return u(this,n),(r=t.call(this,a.WAMP_ERROR_MSG.WEBSOCKET_ERROR)).name="WebsocketError",r.code=38,r.error=e,r}return c(n)}()),e=(t.WebsocketError=e,function(){l(o,p(Error));var n=h(o);function o(e,r){var t;return u(this,o),(t=n.call(this,a.WAMP_ERROR_MSG.FEATURE_NOT_SUPPORTED)).name="FeatureNotSupportedError",t.code=39,t.role=e,t.feature=r,t}return c(o)}());t.FeatureNotSupportedError=e},{"./constants.js":3}],5:[function(e,r,t){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,r){if("object"!==o(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0===t)return("string"===r?String:Number)(e);t=t.call(e,r||"default");if("object"!==o(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===o(e)?e:String(e)}(n.key),n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.JsonSerializer=void 0;var n=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.protocol="json",this.isBinary=!1}var r,t,n;return r=e,(t=[{key:"encode",value:function(e){return JSON.stringify(e)}},{key:"decode",value:function(e){return JSON.parse(e)}}])&&i(r.prototype,t),n&&i(r,n),Object.defineProperty(r,"prototype",{writable:!1}),e}();t.JsonSerializer=n},{}],6:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewPromise=function(){var t={};return t.promise=new Promise(function(e,r){t.onSuccess=e,t.onError=r}),t},t.getWebSocket=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.url,t=e.protocols,n=e.options,e=e.isBrowserMock,n=n||{},o=n.ws,i=n.additionalHeaders,n=n.wsRequestOptions,e=s.isNode&&!e;if(!o&&e)return null;e=(e?function(e){return a(e)?e:null}:function(e){if(a(e))return e;var r="https:"===window.location.protocol?"wss://":"ws://",t=window.location.port?":".concat(window.location.port):"";if(!e)return"".concat(r).concat(window.location.hostname).concat(t,"/ws");if(e.startsWith("/"))return"".concat(r).concat(window.location.hostname).concat(t).concat(e);return"".concat(r).concat(e)})(r);if(!e)return null;if(o)return new o(e,t,null,i,n);return function(e,r){var t;{if(null!=(t=window)&&t.WebSocket)return new window.WebSocket(e,r);if(null!=(t=window)&&t.MozWebSocket)return new window.MozWebSocket(e,r)}return null}(e,t)};var s=e("./constants.js");function a(e){return/^ws(s)?:\/\//.test(e)}},{"./constants.js":3}],7:[function(e,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Wampy=t.Errors=void 0;var O=e("./constants.js"),k=function(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!==A(e)&&"function"!=typeof e)return{default:e};r=s(r);if(r&&r.has(e))return r.get(e);var t,n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(t in e){var i;"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&((i=o?Object.getOwnPropertyDescriptor(e,t):null)&&(i.get||i.set)?Object.defineProperty(n,t,i):n[t]=e[t])}n.default=e,r&&r.set(e,n);return n}(e("./errors.js")),M=(t.Errors=k,e("./utils.js")),C=e("./serializers/JsonSerializer.js");function s(e){var r,t;return"function"!=typeof WeakMap?null:(r=new WeakMap,t=new WeakMap,(s=function(e){return e?t:r})(e))}function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||N(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,o,i,s,a=[],c=!0,u=!1;try{if(i=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;c=!1}else for(;!(c=(n=i.call(t)).done)&&(a.push(n.value),a.length!==r);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=t.return&&(s=t.return(),Object(s)!==s))return}finally{if(u)throw o}}return a}}(e,r)||N(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,r){var t;if(e)return"string"==typeof e?n(e,r):"Map"===(t="Object"===(t=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:t)||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?n(e,r):void 0}function n(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function T(){T=function(){return s};var s={},e=Object.prototype,c=e.hasOwnProperty,u=Object.defineProperty||function(e,r,t){e[r]=t.value},r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",t=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function i(e,r,t){return Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{i({},"")}catch(e){i=function(e,r,t){return e[r]=t}}function a(e,r,t,n){var o,i,s,a,r=r&&r.prototype instanceof p?r:p,r=Object.create(r.prototype),n=new m(n||[]);return u(r,"_invoke",{value:(o=e,i=t,s=n,a="suspendedStart",function(e,r){if("executing"===a)throw new Error("Generator is already running");if("completed"===a){if("throw"===e)throw r;return w()}for(s.method=e,s.arg=r;;){var t=s.delegate;if(t){t=function e(r,t){var n=t.method,o=r.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&r.iterator.return&&(t.method="return",t.arg=void 0,e(r,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;n=l(o,r.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,h;o=n.arg;return o?o.done?(t[r.resultName]=o.value,t.next=r.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}(t,s);if(t){if(t===h)continue;return t}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if("suspendedStart"===a)throw a="completed",s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);a="executing";t=l(o,i,s);if("normal"===t.type){if(a=s.done?"completed":"suspendedYield",t.arg===h)continue;return{value:t.arg,done:s.done}}"throw"===t.type&&(a="completed",s.method="throw",s.arg=t.arg)}})}),r}function l(e,r,t){try{return{type:"normal",arg:e.call(r,t)}}catch(e){return{type:"throw",arg:e}}}s.wrap=a;var h={};function p(){}function _(){}function f(){}var r={},d=(i(r,n,function(){return this}),Object.getPrototypeOf),d=d&&d(d(P([]))),E=(d&&d!==e&&c.call(d,n)&&(r=d),f.prototype=p.prototype=Object.create(r));function y(e){["next","throw","return"].forEach(function(r){i(e,r,function(e){return this._invoke(r,e)})})}function b(s,a){var r;u(this,"_invoke",{value:function(t,n){function e(){return new a(function(e,r){!function r(e,t,n,o){var i,e=l(s[e],s,t);if("throw"!==e.type)return(t=(i=e.arg).value)&&"object"==A(t)&&c.call(t,"__await")?a.resolve(t.__await).then(function(e){r("next",e,n,o)},function(e){r("throw",e,n,o)}):a.resolve(t).then(function(e){i.value=e,n(i)},function(e){return r("throw",e,n,o)});o(e.arg)}(t,n,e,r)})}return r=r?r.then(e,e):e()}})}function v(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function S(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function m(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(v,this),this.reset(!0)}function P(r){if(r){var t,e=r[n];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length))return t=-1,(e=function e(){for(;++t<r.length;)if(c.call(r,t))return e.value=r[t],e.done=!1,e;return e.value=void 0,e.done=!0,e}).next=e}return{next:w}}function w(){return{value:void 0,done:!0}}return u(E,"constructor",{value:_.prototype=f,configurable:!0}),u(f,"constructor",{value:_,configurable:!0}),_.displayName=i(f,o,"GeneratorFunction"),s.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},s.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,i(e,o,"GeneratorFunction")),e.prototype=Object.create(E),e},s.awrap=function(e){return{__await:e}},y(b.prototype),i(b.prototype,t,function(){return this}),s.AsyncIterator=b,s.async=function(e,r,t,n,o){void 0===o&&(o=Promise);var i=new b(a(e,r,t,n),o);return s.isGeneratorFunction(r)?i:i.next().then(function(e){return e.done?e.value:i.next()})},y(E),i(E,o,"Generator"),i(E,n,function(){return this}),i(E,"toString",function(){return"[object Generator]"}),s.keys=function(e){var r,t=Object(e),n=[];for(r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},s.values=P,m.prototype={constructor:m,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&c.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function e(e,r){return i.type="throw",i.arg=t,n.next=e,r&&(n.method="next",n.arg=void 0),!!r}for(var r=this.tryEntries.length-1;0<=r;--r){var o=this.tryEntries[r],i=o.completion;if("root"===o.tryLoc)return e("end");if(o.tryLoc<=this.prev){var s=c.call(o,"catchLoc"),a=c.call(o,"finallyLoc");if(s&&a){if(this.prev<o.catchLoc)return e(o.catchLoc,!0);if(this.prev<o.finallyLoc)return e(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return e(o.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return e(o.finallyLoc)}}}},abrupt:function(e,r){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.tryLoc<=this.prev&&c.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}var i=(o=o&&("break"===e||"continue"===e)&&o.tryLoc<=r&&r<=o.finallyLoc?null:o)?o.completion:{};return i.type=e,i.arg=r,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(i)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),h},finish:function(e){for(var r=this.tryEntries.length-1;0<=r;--r){var t=this.tryEntries[r];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),S(t),h}},catch:function(e){for(var r=this.tryEntries.length-1;0<=r;--r){var t,n,o=this.tryEntries[r];if(o.tryLoc===e)return"throw"===(t=o.completion).type&&(n=t.arg,S(o)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,r,t){return this.delegate={iterator:P(e),resultName:r,nextLoc:t},"next"===this.method&&(this.arg=void 0),h}},s}function c(e,r,t,n,o,i,s){try{var a=e[i](s),c=a.value}catch(e){return void t(e)}a.done?r(c):Promise.resolve(c).then(n,o)}function L(a){return function(){var e=this,s=arguments;return new Promise(function(r,t){var n=a.apply(e,s);function o(e){c(n,r,t,o,i,"next",e)}function i(e){c(n,r,t,o,i,"throw",e)}o(void 0)})}}function o(r,e){var t,n=Object.keys(r);return Object.getOwnPropertySymbols&&(t=Object.getOwnPropertySymbols(r),e&&(t=t.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),n.push.apply(n,t)),n}function W(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?o(Object(t),!0).forEach(function(e){B(r,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))})}return r}function B(e,r,t){(r=i(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t}function G(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){e=function(e,r){if("object"!==A(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0===t)return("string"===r?String:Number)(e);t=t.call(e,r||"default");if("object"!==A(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===A(e)?e:String(e)}var j=new C.JsonSerializer,e=function(){function t(e,r){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.version="v7.1.0",this._url="string"==typeof e?e:null,this._protocols=["wamp.2.json"],this._wamp_features={agent:"Wampy.js "+this.version,roles:{publisher:{features:{subscriber_blackwhite_listing:!0,publisher_exclusion:!0,publisher_identification:!0,payload_passthru_mode:!0}},subscriber:{features:{pattern_based_subscription:!0,publication_trustlevels:!0,publisher_identification:!0,payload_passthru_mode:!0}},caller:{features:{caller_identification:!0,progressive_call_results:!0,call_canceling:!0,call_timeout:!0,payload_passthru_mode:!0}},callee:{features:{caller_identification:!0,call_trustlevels:!0,pattern_based_registration:!0,shared_registration:!0,payload_passthru_mode:!0}}}},this._cache={sessionId:null,reqId:0,server_wamp_features:{roles:{}},isSayingGoodbye:!1,opStatus:{code:0,error:null,reqId:0},timer:null,reconnectingAttempts:0,connectPromise:null,closePromise:null},this._ws=null,this._wsQueue=[],this._requests={},this._calls={},this._subscriptionsById=new Map,this._subscriptionsByKey=new Map,this._rpcRegs={},this._rpcNames=new Set,this._options={debug:!1,logger:null,autoReconnect:!0,reconnectInterval:2e3,maxRetries:25,realm:null,helloCustomDetails:null,uriValidation:"strict",authid:null,authmethods:[],authextra:{},authPlugins:{},authMode:"manual",onChallenge:null,onClose:null,onError:null,onReconnect:null,onReconnectSuccess:null,ws:null,additionalHeaders:null,wsRequestOptions:null,serializer:j,payloadSerializers:{json:j}},this._isPlainObject(r)?this._options=W(W({},this._options),r):this._isPlainObject(e)&&(this._options=W(W({},this._options),e))}var e,r,n,o,i,s,a,c,u,l,h,p,_,f,d,E,y,b,v,S,m,P,w,g,R;return e=t,(r=[{key:"_log",value:function(){if(this._options.debug){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return this._options.logger?this._options.logger(r):void 0}}},{key:"_getReqId",value:function(){return++this._cache.reqId}},{key:"_isPlainObject",value:function(e){var r=null==e?void 0:e.constructor,t=null==r?void 0:r.prototype;return"[object Object]"===Object.prototype.toString.call(e)&&"function"==typeof r&&"[object Object]"===Object.prototype.toString.call(t)&&Object.hasOwnProperty.call(t,"isPrototypeOf")}},{key:"_setWsProtocols",value:function(){this._protocols=["wamp.2."+this._options.serializer.protocol]}},{key:"_fillOpStatusByError",value:function(e){this._cache.opStatus={code:e.code,error:e,reqId:0}}},{key:"_preReqChecks",value:function(e,r){var t;return this._cache.sessionId&&!this._cache.server_wamp_features.roles[r]?(t={dealer:new k.NoDealerError,broker:new k.NoBrokerError},this._fillOpStatusByError(t[r]),!1):!(e&&!this._validateURI(e.topic,e.patternBased,e.allowWAMP))||(this._fillOpStatusByError(new k.UriError),!1)}},{key:"_checkRouterFeature",value:function(e,r){return!0===this._cache.server_wamp_features.roles[e].features[r]||(this._fillOpStatusByError(new k.FeatureNotSupportedError(e,r)),!1)}},{key:"_checkPPTOptions",value:function(e,r){return this._checkRouterFeature(e,"payload_passthru_mode")?r.ppt_scheme.search(/^(wamp$|mqtt$|x_)/)<0?(this._fillOpStatusByError(new k.PPTInvalidSchemeError),!1):!("wamp"===r.ppt_scheme&&!O.E2EE_SERIALIZERS.includes(r.ppt_serializer))||(this._fillOpStatusByError(new k.PPTSerializerInvalidError),!1):(this._fillOpStatusByError(new k.PPTNotSupportedError),!1)}},{key:"_validateURI",value:function(e,r,t){var n,o,i="strict"===this._options.uriValidation,s="loose"===this._options.uriValidation;return!(!i&&!s||e.startsWith("wamp.")&&!t)&&(i?(n=/^(\w+\.)*(\w+)$/,o=/^(\w+\.{1,2})*(\w+)$/):s&&(n=/^([^\s.#]+\.)*([^\s.#]+)$/,o=/^([^\s.#]+\.{1,2})*([^\s.#]+)$/),(r?o:n).test(e))}},{key:"_packPPTPayload",value:function(e,r){var t=(null==e?void 0:e.argsList)&&!Array.isArray(e.argsList),n=(null==e?void 0:e.argsDict)&&!this._isPlainObject(e.argsDict);if(t||n)return n=t?e.argsList:e.argsDict,this._fillOpStatusByError(new k.InvalidParamError(n)),{err:!0,payloadItems:[]};var o,i,t=this._isPlainObject(e),n=e.argsList,s=e.argsDict,t=(!t||n||s?t?(o=n,i=s):o=Array.isArray(e)?e:[e]:i=e,[]);if(r.ppt_scheme){n={args:o,kwargs:i},s=n;if(r.ppt_serializer&&"native"!==r.ppt_serializer){e=this._options.payloadSerializers[r.ppt_serializer];if(!e)return this._fillOpStatusByError(new k.PPTSerializerInvalidError),{err:!0,payloadItems:t};try{s=e.encode(n)}catch(e){return this._fillOpStatusByError(new k.PPTSerializationError),{err:!0,payloadItems:t}}}t.push([s])}else o&&t.push(o),i&&(o||t.push([]),t.push(i));return{err:!1,payloadItems:t}}},{key:"_unpackPPTPayload",value:function(e,r,t){var n;if(!this._checkPPTOptions(e,t))return{err:this._cache.opStatus.error};if(t.ppt_serializer&&"native"!==t.ppt_serializer){e=this._options.payloadSerializers[t.ppt_serializer];if(!e)return{err:new k.PPTSerializerInvalidError};try{n=e.decode(r)}catch(e){return{err:new k.PPTSerializationError}}}else n=r;return{err:!1,args:n.args,kwargs:n.kwargs}}},{key:"_encode",value:function(e){try{return this._options.serializer.encode(e)}catch(e){this._hardClose("wamp.error.protocol_violation","Can not encode message",!0)}}},{key:"_decode",value:function(e){try{return this._options.serializer.decode(e)}catch(e){this._hardClose("wamp.error.protocol_violation","Can not decode received message")}}},{key:"_hardClose",value:function(e,r){var t=2<arguments.length&&void 0!==arguments[2]&&arguments[2],t=(this._log(r),this._wsQueue=[],t||this._send([O.WAMP_MSG_SPEC.ABORT,{message:r},e]),new k.ProtocolViolationError(e,r));this._cache.connectPromise&&(this._cache.connectPromise.onError(t),this._cache.connectPromise=null),this._options.onError&&this._options.onError(t),this._ws.close()}},{key:"_send",value:function(e){if(e&&this._wsQueue.push(this._encode(e)),this._ws&&1===this._ws.readyState&&this._cache.sessionId)for(;this._wsQueue.length;)this._ws.send(this._wsQueue.shift())}},{key:"_resetState",value:function(){this._wsQueue=[],this._subscriptionsById.clear(),this._subscriptionsByKey.clear(),this._requests={},this._calls={},this._rpcRegs={},this._rpcNames=new Set,this._cache={reqId:0,reconnectingAttempts:0,opStatus:O.SUCCESS,closePromise:null,connectPromise:null}}},{key:"_initWsCallbacks",value:function(){var r=this;this._ws.onopen=function(){return r._wsOnOpen()},this._ws.onclose=function(e){return r._wsOnClose(e)},this._ws.onmessage=function(e){return r._wsOnMessage(e)},this._ws.onerror=function(e){return r._wsOnError(e)}}},{key:"_wsOnOpen",value:function(){var e=this._options,r=e.helloCustomDetails,t=e.authmethods,n=e.authid,o=e.authextra,i=e.serializer,s=e.onError,e=e.realm,a=null==(a=this._ws.protocol)||null==(a=a.split("."))?void 0:a[2],c=a===i.protocol,a=(this._log('Websocket connected. Server has chosen protocol: "'.concat(a,'"')),c||("json"===a?this._options.serializer=new C.JsonSerializer:(c=new k.NoSerializerAvailableError,this._fillOpStatusByError(c),this._cache.connectPromise&&(this._cache.connectPromise.onError(c),this._cache.connectPromise=null),s&&s(c))),i.isBinary&&(this._ws.binaryType="arraybuffer"),W(W(W({},r),this._wamp_features),n?{authid:n,authmethods:t,authextra:o}:{})),s=this._encode([O.WAMP_MSG_SPEC.HELLO,e,a]);s&&this._ws.send(s)}},{key:"_wsOnClose",value:function(e){var r=this;this._log("websocket disconnected. Info: ",e),(this._cache.sessionId||this._cache.reconnectingAttempts)&&this._options.autoReconnect&&(0===this._options.maxRetries||this._cache.reconnectingAttempts<this._options.maxRetries)&&!this._cache.isSayingGoodbye?(this._cache.sessionId=null,this._cache.timer=setTimeout(function(){r._wsReconnect()},this._options.reconnectInterval)):(this._options.onClose&&this._options.onClose(),this._cache.closePromise&&(this._cache.closePromise.onSuccess(),this._cache.closePromise=null),this._resetState(),this._ws=null)}},{key:"_wsOnMessage",value:(R=L(T().mark(function e(r){var t,n,o,i,s,a,c=this;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._decode(r.data),this._log("websocket message received: ",t),n=t[0],B(o={},O.WAMP_MSG_SPEC.WELCOME,function(){return c._onWelcomeMessage(t)}),B(o,O.WAMP_MSG_SPEC.ABORT,function(){return c._onAbortMessage(t)}),B(o,O.WAMP_MSG_SPEC.CHALLENGE,function(){return c._onChallengeMessage(t)}),B(o,O.WAMP_MSG_SPEC.GOODBYE,function(){return c._onGoodbyeMessage(t)}),B(o,O.WAMP_MSG_SPEC.ERROR,function(){return c._onErrorMessage(t)}),B(o,O.WAMP_MSG_SPEC.SUBSCRIBED,function(){return c._onSubscribedMessage(t)}),B(o,O.WAMP_MSG_SPEC.UNSUBSCRIBED,function(){return c._onUnsubscribedMessage(t)}),B(o,O.WAMP_MSG_SPEC.PUBLISHED,function(){return c._onPublishedMessage(t)}),B(o,O.WAMP_MSG_SPEC.EVENT,function(){return c._onEventMessage(t)}),B(o,O.WAMP_MSG_SPEC.RESULT,function(){return c._onResultMessage(t)}),B(o,O.WAMP_MSG_SPEC.REGISTERED,function(){return c._onRegisteredMessage(t)}),B(o,O.WAMP_MSG_SPEC.UNREGISTERED,function(){return c._onUnregisteredMessage(t)}),B(o,O.WAMP_MSG_SPEC.INVOCATION,function(){return c._onInvocationMessage(t)}),i="wamp.error.protocol_violation",o=o[n]){e.next=8;break}return e.abrupt("return",this._hardClose(i,'Received non-compliant WAMP message: "'.concat(n,'"')));case 8:if(s=[O.WAMP_MSG_SPEC.WELCOME,O.WAMP_MSG_SPEC.CHALLENGE].includes(n),a=!s&&n!==O.WAMP_MSG_SPEC.ABORT,s&&this._cache.sessionId)return e.abrupt("return",this._hardClose(i,'Received message "'.concat(n,'" after session was established')));e.next=12;break;case 12:if(a&&!this._cache.sessionId)return e.abrupt("return",this._hardClose(i,'Received message "'.concat(n,'" before session was established')));e.next=14;break;case 14:if(this._isRequestIdValid(t))return e.next=17,o();e.next=17;break;case 17:case"end":return e.stop()}},e,this)})),function(e){return R.apply(this,arguments)})},{key:"_isRequestIdValid",value:function(e){var e=x(e,2),r=e[0],e=e[1];return![O.WAMP_MSG_SPEC.SUBSCRIBED,O.WAMP_MSG_SPEC.UNSUBSCRIBED,O.WAMP_MSG_SPEC.PUBLISHED,O.WAMP_MSG_SPEC.RESULT,O.WAMP_MSG_SPEC.REGISTERED,O.WAMP_MSG_SPEC.UNREGISTERED].includes(r)||(!(r!==O.WAMP_MSG_SPEC.RESULT||!this._calls[e])||!!this._requests[e])}},{key:"_onWelcomeMessage",value:(g=L(T().mark(function e(r){var t,n;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=x(r,3),t=n[1],n=n[2],this._cache.sessionId=t,this._cache.server_wamp_features=n,this._cache.reconnectingAttempts){if(this._cache.reconnectingAttempts=0,this._options.onReconnectSuccess)return e.next=8,this._options.onReconnectSuccess(n);e.next=8}else e.next=12;break;case 8:this._renewSubscriptions(),this._renewRegistrations(),e.next=14;break;case 12:this._cache.connectPromise.onSuccess(n),this._cache.connectPromise=null;case 14:this._send();case 15:case"end":return e.stop()}},e,this)})),function(e){return g.apply(this,arguments)})},{key:"_onAbortMessage",value:(w=L(T().mark(function e(r){var t,n;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=x(r,3),t=n[1],n=n[2],n=new k.AbortError({error:n,details:t}),this._cache.connectPromise&&(this._cache.connectPromise.onError(n),this._cache.connectPromise=null),this._options.onError)return e.next=6,this._options.onError(n);e.next=6;break;case 6:this._ws.close();case 7:case"end":return e.stop()}},e,this)})),function(e){return w.apply(this,arguments)})},{key:"_onChallengeMessage",value:(P=L(T().mark(function e(r){var t,n,o,i,s,a,c,u,l,h;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:l=x(r,3),t=l[1],n=l[2],l=this._options,i=l.authid,s=l.authMode,a=l.onChallenge,c=l.onError,u=l.authPlugins,i&&"manual"===s&&"function"==typeof a?(o=new Promise(function(e){e(a(t,n))}),e.next=17):e.next=6;break;case 6:i&&"auto"===s&&"function"==typeof u[t]?(o=new Promise(function(e){e(u[t](t,n))}),e.next=17):e.next=10;break;case 10:if(l=new k.NoCRACallbackOrIdError,this._fillOpStatusByError(l),this._ws.send(this._encode([O.WAMP_MSG_SPEC.ABORT,{message:l.message},"wamp.error.cannot_authenticate"])),c)return e.next=16,c(l);e.next=16;break;case 16:return e.abrupt("return",this._ws.close());case 17:return e.prev=17,e.next=20,o;case 20:h=e.sent,this._ws.send(this._encode([O.WAMP_MSG_SPEC.AUTHENTICATE,h,{}])),e.next=33;break;case 24:if(e.prev=24,e.t0=e.catch(17),h=new k.ChallengeExceptionError,this._fillOpStatusByError(h),this._ws.send(this._encode([O.WAMP_MSG_SPEC.ABORT,{message:h.message},"wamp.error.cannot_authenticate"])),c)return e.next=32,c(h);e.next=32;break;case 32:this._ws.close();case 33:case"end":return e.stop()}},e,this,[[17,24]])})),function(e){return P.apply(this,arguments)})},{key:"_onGoodbyeMessage",value:(m=L(T().mark(function e(){return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this._cache.isSayingGoodbye||(this._cache.isSayingGoodbye=!0,this._send([O.WAMP_MSG_SPEC.GOODBYE,{},"wamp.close.goodbye_and_out"])),this._cache.sessionId=null,this._ws.close();case 3:case"end":return e.stop()}},e,this)})),function(){return m.apply(this,arguments)})},{key:"_onErrorMessage",value:(S=L(T().mark(function e(r){var t,n,o,i,s,a;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=x(r,7),t=i[1],n=i[2],a=i[3],s=i[4],o=i[5],i=i[6],s={error:s,details:a,argsList:o,argsDict:i},B(a={},O.WAMP_MSG_SPEC.SUBSCRIBE,new k.SubscribeError(s)),B(a,O.WAMP_MSG_SPEC.UNSUBSCRIBE,new k.UnsubscribeError(s)),B(a,O.WAMP_MSG_SPEC.PUBLISH,new k.PublishError(s)),B(a,O.WAMP_MSG_SPEC.REGISTER,new k.RegisterError(s)),B(a,O.WAMP_MSG_SPEC.UNREGISTER,new k.UnregisterError(s)),B(a,O.WAMP_MSG_SPEC.CALL,new k.CallError(s)),o=a[t]){e.next=6;break}return e.abrupt("return",this._hardClose("wamp.error.protocol_violation","Received invalid ERROR message"));case 6:if(t!==O.WAMP_MSG_SPEC.CALL)e.next=13;else{if(null!=(i=this._calls[n])&&i.onError)return e.next=10,this._calls[n].onError(o);e.next=10}break;case 10:delete this._calls[n],e.next=17;break;case 13:if(null!=(s=this._requests[n])&&null!=(a=s.callbacks)&&a.onError)return e.next=16,this._requests[n].callbacks.onError(o);e.next=16;break;case 16:delete this._requests[n];case 17:case"end":return e.stop()}},e,this)})),function(e){return S.apply(this,arguments)})},{key:"_onSubscribedMessage",value:(v=L(T().mark(function e(r){var t,n,o,i,s,a;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=x(r,3),t=n[1],n=n[2],i=this._requests[t],o=i.topic,a=i.advancedOptions,i=i.callbacks,s={id:n,topic:o,advancedOptions:a,callbacks:[i.onEvent]},a=this._getSubscriptionKey(o,a),this._subscriptionsById.set(n,s),this._subscriptionsByKey.set(a,s),i.onSuccess)return e.next=9,i.onSuccess({topic:o,requestId:t,subscriptionId:n,subscriptionKey:a});e.next=9;break;case 9:delete this._requests[t];case 10:case"end":return e.stop()}},e,this)})),function(e){return v.apply(this,arguments)})},{key:"_onUnsubscribedMessage",value:(b=L(T().mark(function e(r){var t,n,o,i,s;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=x(r,2),t=t[1],o=this._requests[t],n=o.topic,i=o.advancedOptions,o=o.callbacks,i=this._getSubscriptionKey(n,i),s=this._subscriptionsByKey.get(i).id,this._subscriptionsByKey.delete(i),this._subscriptionsById.delete(s),o.onSuccess)return e.next=9,o.onSuccess({topic:n,requestId:t});e.next=9;break;case 9:delete this._requests[t];case 10:case"end":return e.stop()}},e,this)})),function(e){return b.apply(this,arguments)})},{key:"_onPublishedMessage",value:(y=L(T().mark(function e(r){var t,n,o,i;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=x(r,3),t=n[1],n=n[2],i=this._requests[t],o=i.topic,null!=(i=i.callbacks)&&i.onSuccess)return e.next=5,i.onSuccess({topic:o,requestId:t,publicationId:n});e.next=5;break;case 5:delete this._requests[t];case 6:case"end":return e.stop()}},e,this)})),function(e){return y.apply(this,arguments)})},{key:"_onEventMessage",value:(E=L(T().mark(function e(r){var t,n,o,i,s,a,c,u,l;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=x(r,6),i=o[1],o[2],t=o[3],n=o[4],o=o[5],i=this._subscriptionsById.get(i)){e.next=4;break}return e.abrupt("return");case 4:if(s=n,a=o,t.ppt_scheme){if(c=n[0],(c=this._unpackPPTPayload("broker",c,t)).err)return e.abrupt("return",this._log(c.err.message));e.next=11}else e.next=13;break;case 11:s=c.args,a=c.kwargs;case 13:return u={details:t,argsList:s,argsDict:a},l=i.callbacks.map(function(e){return e(u)}),e.next=17,Promise.all(l);case 17:case"end":return e.stop()}},e,this)})),function(e){return E.apply(this,arguments)})},{key:"_onResultMessage",value:(d=L(T().mark(function e(r){var t,n,o,i,s,a,c;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=x(r,5),t=i[1],n=i[2],s=i[3],i=i[4],o=s,i=i,n.ppt_scheme){if(s=s[0],(a=this._unpackPPTPayload("dealer",s,n)).err)return this._log(a.err.message),this._cache.opStatus=a.err,e.next=11,this._calls[t].onError(new k.CallError({details:n,error:"wamp.error.invocation_exception",argsList:[a.err.message],argsDict:null}));e.next=13}else e.next=15;break;case 11:return delete this._calls[t],e.abrupt("return");case 13:o=a.args,i=a.kwargs;case 15:if(c={details:n,argsList:o,argsDict:i},n.progress)return e.next=19,this._calls[t].onProgress(c);e.next=21;break;case 19:e.next=24;break;case 21:return e.next=23,this._calls[t].onSuccess(c);case 23:delete this._calls[t];case 24:case"end":return e.stop()}},e,this)})),function(e){return d.apply(this,arguments)})},{key:"_onRegisteredMessage",value:(f=L(T().mark(function e(r){var t,n,o,i,s;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=x(r,3),t=n[1],n=n[2],s=this._requests[t],o=s.topic,i=s.callbacks,s=s.advancedOptions,this._rpcRegs[n]={id:n,callbacks:[i.rpc],advancedOptions:s},this._rpcRegs[o]=this._rpcRegs[n],this._rpcNames.add(o),null!=i&&i.onSuccess)return e.next=8,i.onSuccess({topic:o,requestId:t,registrationId:n});e.next=8;break;case 8:delete this._requests[t];case 9:case"end":return e.stop()}},e,this)})),function(e){return f.apply(this,arguments)})},{key:"_onUnregisteredMessage",value:(_=L(T().mark(function e(r){var t,n,o;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=x(r,2),t=t[1],o=this._requests[t],n=o.topic,o=o.callbacks,delete this._rpcRegs[this._rpcRegs[n].id],delete this._rpcRegs[n],this._rpcNames.has(n)&&this._rpcNames.delete(n),null!=o&&o.onSuccess)return e.next=8,o.onSuccess({topic:n,requestId:t});e.next=8;break;case 8:delete this._requests[t];case 9:case"end":return e.stop()}},e,this)})),function(e){return _.apply(this,arguments)})},{key:"_onInvocationMessage",value:(p=L(T().mark(function e(r){var a,t,n,o,i,c,u,s,l,h,p,_,f=this;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=x(r,6),a=i[1],t=i[2],n=i[3],o=i[4],i=i[5],u=function(e){var r=e.error,t=e.details,n=e.argsList,e=e.argsDict,t=[O.WAMP_MSG_SPEC.ERROR,O.WAMP_MSG_SPEC.INVOCATION,a,t||{},r||"wamp.error.invocation_exception"];Array.isArray(n)&&t.push(n),c._isPlainObject(e)&&(Array.isArray(n)||t.push([]),t.push(e)),c._send(t)},(c=this)._rpcRegs[t]){e.next=6;break}return this._log(O.WAMP_ERROR_MSG.NON_EXIST_RPC_INVOCATION),e.abrupt("return",u({error:"wamp.error.no_such_procedure"}));case 6:if(s=o,l=i,null!=n&&n.ppt_scheme)if(h=o[0],(h=this._unpackPPTPayload("dealer",h,n)).err){if(this._log(h.err.message),h.err instanceof k.PPTNotSupportedError)return e.abrupt("return",this._hardClose("wamp.error.protocol_violation","Received INVOCATION in PPT Mode, while Dealer didn't announce it"));e.next=15}else e.next=16;else e.next=18;break;case 15:return e.abrupt("return",u({details:n,error:"wamp.error.invocation_exception",argsList:[h.err.message]}));case 16:s=h.args,l=h.kwargs;case 18:return p=function(e){var r,t=(null==e?void 0:e.options)||{},n=t.ppt_scheme,o=t.ppt_serializer,i=t.ppt_cipher,s=t.ppt_keyid;return n&&!f._checkPPTOptions("dealer",t)?f._cache.opStatus.error instanceof k.PPTNotSupportedError?f._hardClose("wamp.error.protocol_violation","Trying to send YIELD in PPT Mode, while Dealer didn't announce it"):u({details:t,error:"wamp.error.invalid_option",argsList:[f._cache.opStatus.error.message]}):(r=(e=e?f._packPPTPayload(e,t):{}).err,e=e.payloadItems,r?u({details:t,error:"wamp.error.invocation_exception",argsList:[f._cache.opStatus.error.message]}):(r=W(W(W(W(W({},t),n?{ppt_scheme:n}:{}),o?{ppt_serializer:o}:{}),i?{ppt_cipher:i}:{}),s?{ppt_keyid:s}:{}),void c._send([O.WAMP_MSG_SPEC.YIELD,a,r].concat(I(e||[])))))},e.prev=19,e.next=22,this._rpcRegs[t].callbacks[0]({details:n,argsList:s,argsDict:l,result_handler:p,error_handler:u});case 22:_=e.sent,p(_),e.next=29;break;case 26:e.prev=26,e.t0=e.catch(19),u(e.t0);case 29:case"end":return e.stop()}},e,this,[[19,26]])})),function(e){return p.apply(this,arguments)})},{key:"_wsOnError",value:function(e){this._log("websocket error");e=new k.WebsocketError(e);this._cache.connectPromise&&(this._cache.connectPromise.onError(e),this._cache.connectPromise=null),this._options.onError&&this._options.onError(e)}},{key:"_wsReconnect",value:function(){this._log("websocket reconnecting..."),this._options.onReconnect&&this._options.onReconnect(),this._cache.reconnectingAttempts++,this._ws=(0,M.getWebSocket)({url:this._url,protocols:this._protocols,options:this._options}),this._initWsCallbacks()}},{key:"_renewSubscriptions",value:function(){var r,t=this,e=new Map(this._subscriptionsById);this._subscriptionsById.clear(),this._subscriptionsByKey.clear(),e.forEach(function(e){for(r=e.callbacks.length;r--;)t.subscribe(e.topic,e.callbacks[r],e.advancedOptions)})}},{key:"_renewRegistrations",value:function(){var e,r=this._rpcRegs,t=this._rpcNames,n=(this._rpcRegs={},this._rpcNames=new Set,function(e,r){var t,n,o,i,s="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(s)return n=!(t=!0),{s:function(){s=s.call(e)},n:function(){var e=s.next();return t=e.done,e},e:function(e){n=!0,o=e},f:function(){try{t||null==s.return||s.return()}finally{if(n)throw o}}};if(Array.isArray(e)||(s=N(e))||r&&e&&"number"==typeof e.length)return s&&(e=s),i=0,{s:r=function(){},n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(t));try{for(n.s();!(e=n.n()).done;){var o=e.value;this.register(o,r[o].callbacks[0],r[o].advancedOptions)}}catch(e){n.e(e)}finally{n.f()}}},{key:"_getSubscriptionKey",value:function(e,r){return"".concat(e,"-").concat(JSON.stringify(r))}},{key:"options",value:function(e){return void 0===e?this._options:this._isPlainObject(e)?(this._options=W(W({},this._options),e),this):void 0}},{key:"getOptions",value:function(){return this._options}},{key:"setOptions",value:function(e){if(this._isPlainObject(e))return this._options=W(W({},this._options),e),this}},{key:"getOpStatus",value:function(){return this._cache.opStatus}},{key:"getSessionId",value:function(){return this._cache.sessionId}},{key:"connect",value:(h=L(T().mark(function e(r){var t,n,o;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&(this._url=r),this._options.realm){e.next=5;break}throw t=new k.NoRealmError,this._fillOpStatusByError(t),t;case 5:if(0<(t=(this._options.authid?1:0)+(Array.isArray(this._options.authmethods)&&this._options.authmethods.length?1:0)+("function"==typeof this._options.onChallenge||Object.keys(this._options.authPlugins).length?1:0))&&t<3)throw n=new k.NoCRACallbackOrIdError,this._fillOpStatusByError(n),n;e.next=10;break;case 10:if(this._setWsProtocols(),this._ws=(0,M.getWebSocket)({url:this._url,protocols:this._protocols,options:this._options}),this._ws){e.next=16;break}throw n=new k.NoWsOrUrlError,this._fillOpStatusByError(n),n;case 16:return this._initWsCallbacks(),o=(0,M.getNewPromise)(),this._cache.connectPromise=o,e.abrupt("return",o.promise);case 20:case"end":return e.stop()}},e,this)})),function(e){return h.apply(this,arguments)})},{key:"disconnect",value:(l=L(T().mark(function e(){var r;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._cache.sessionId)return r=(0,M.getNewPromise)(),this._cache.opStatus=O.SUCCESS,this._cache.closePromise=r,this._cache.isSayingGoodbye=!0,this._send([O.WAMP_MSG_SPEC.GOODBYE,{},"wamp.close.system_shutdown"]),e.abrupt("return",r.promise);e.next=9;break;case 9:this._ws&&this._ws.close();case 10:return e.abrupt("return",!0);case 11:case"end":return e.stop()}},e,this)})),function(){return l.apply(this,arguments)})},{key:"abort",value:function(){return this._cache.sessionId||1!==this._ws.readyState||(this._send([O.WAMP_MSG_SPEC.ABORT,{},"wamp.error.abort"]),this._cache.sessionId=null),this._ws.close(),this._cache.opStatus=O.SUCCESS,this}},{key:"subscribe",value:(u=L(T().mark(function e(r,t,n){var o,i,s,a,c,u,l;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((o=this._isPlainObject(n))||void 0===n){e.next=5;break}throw a=new k.InvalidParamError("advancedOptions"),this._fillOpStatusByError(a),a;case 5:if(s=!1,!o||!Object.prototype.hasOwnProperty.call(n,"match")){e.next=13;break}if(["exact","prefix","wildcard"].includes(n.match)){e.next=11;break}throw a=new k.InvalidParamError("match"),this._fillOpStatusByError(a),a;case 11:i=n.match,s=!0;case 13:if(this._preReqChecks({topic:r,patternBased:s,allowWAMP:!0},"broker")){e.next=15;break}throw this._cache.opStatus.error;case 15:if("function"!=typeof t)throw c=new k.NoCallbackError,this._fillOpStatusByError(c),c;e.next=19;break;case 19:if(c=this._getSubscriptionKey(r,n),(u=this._subscriptionsByKey.get(c))&&0<u.callbacks.length)return u.callbacks.includes(t)||u.callbacks.push(t),e.abrupt("return",{topic:r,requestId:0,subscriptionId:u.id,subscriptionKey:c});e.next=24;break;case 24:return u=this._getReqId(),(l=(0,M.getNewPromise)()).onEvent=t,this._requests[u]={topic:r,callbacks:l,advancedOptions:n},this._send([O.WAMP_MSG_SPEC.SUBSCRIBE,u,{match:i},r]),this._cache.opStatus=W(W({},O.SUCCESS),{},{reqId:u||0}),e.abrupt("return",l.promise);case 31:case"end":return e.stop()}},e,this)})),function(e,r,t){return u.apply(this,arguments)})},{key:"unsubscribe",value:(c=L(T().mark(function e(r,t){var n,o;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._preReqChecks(null,"broker")){e.next=2;break}throw this._cache.opStatus.error;case 2:if(n=this._subscriptionsById.get(r)||this._subscriptionsByKey.get(r)){e.next=7;break}throw o=new k.NonExistUnsubscribeError,this._fillOpStatusByError(o),o;case 7:if(n.callbacks="function"==typeof t?n.callbacks.filter(function(e){return e!==t}):[],0<n.callbacks.length)return this._cache.opStatus=O.SUCCESS,e.abrupt("return",!0);e.next=12;break;case 12:return o=this._getReqId(),this._requests[o]={topic:n.topic,callbacks:(0,M.getNewPromise)()},this._send([O.WAMP_MSG_SPEC.UNSUBSCRIBE,o,n.id]),this._cache.opStatus=W(W({},O.SUCCESS),{},{reqId:o}),e.abrupt("return",this._requests[o].callbacks.promise);case 17:case"end":return e.stop()}},e,this)})),function(e,r){return c.apply(this,arguments)})},{key:"publish",value:(a=L(T().mark(function e(r,t,n){var o,i,s,a,c,u,l,h,p,_,f,d,E;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._preReqChecks({topic:r,patternBased:!1,allowWAMP:!1},"broker")){e.next=2;break}throw this._cache.opStatus.error;case 2:if(o=this._isPlainObject(n),n&&!o)throw s=new k.InvalidParamError("advancedOptions"),this._fillOpStatusByError(s),s;e.next=7;break;case 7:if(i={},s=function(e,r){if(n[e])if(Array.isArray(n[e])&&n[e].length)i[e]=n[e];else{if(A(n[e])!==r)return!1;i[e]=[n[e]]}return!0},!o||s("exclude","number")&&s("exclude_authid","string")&&s("exclude_authrole","string")&&s("eligible","number")&&s("eligible_authid","string")&&s("eligible_authrole","string")){e.next=13;break}throw a=new k.InvalidParamError("advancedOptions"),this._fillOpStatusByError(a),a;case 13:if(c=(a=n||{}).ppt_scheme,u=a.ppt_serializer,l=a.ppt_cipher,h=a.ppt_keyid,p=a.exclude_me,_=a.disclose_me,c&&!this._checkPPTOptions("broker",n))throw this._cache.opStatus.error;e.next=16;break;case 16:if(i=W(W(W(W(W(W(W(W({acknowledge:!0},i),c?{ppt_scheme:c}:{}),c?{ppt_scheme:c}:{}),u?{ppt_serializer:u}:{}),l?{ppt_cipher:l}:{}),h?{ppt_keyid:h}:{}),p?{exclude_me:p}:{}),_?{disclose_me:_}:{}),d=t?this._packPPTPayload(t,i):{},f=d.err,d=d.payloadItems,E=this._getReqId(),f)throw this._cache.opStatus.error;e.next=21;break;case 21:return this._requests[E]={topic:r,callbacks:(0,M.getNewPromise)()},this._cache.opStatus=W(W({},O.SUCCESS),{},{reqId:E}),this._send([O.WAMP_MSG_SPEC.PUBLISH,E,i,r].concat(I(d||[]))),e.abrupt("return",this._requests[E].callbacks.promise);case 25:case"end":return e.stop()}},e,this)})),function(e,r,t){return a.apply(this,arguments)})},{key:"call",value:(s=L(T().mark(function e(r,t,n){var o,i,s,a,c,u,l,h,p,_,f,d,E,y;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._preReqChecks({topic:r,patternBased:!1,allowWAMP:!0},"dealer")){e.next=2;break}throw this._cache.opStatus.error;case 2:if(n&&!this._isPlainObject(n))throw o=new k.InvalidParamError("advancedOptions"),this._fillOpStatusByError(o),o;e.next=6;break;case 6:if(i=(o=n||{}).timeout,s=o.progress_callback,a=o.disclose_me,c=s&&"function"!=typeof s,(d=i&&"number"!=typeof i)||c)throw c=d?"timeout":"progress_callback",d=new k.InvalidParamError(c),this._fillOpStatusByError(d),d;e.next=14;break;case 14:if(u=(c=n||{}).ppt_scheme,l=c.ppt_serializer,h=c.ppt_cipher,p=c.ppt_keyid,u&&!this._checkPPTOptions("dealer",n))throw this._cache.opStatus.error;e.next=17;break;case 17:for(;(_=this._getReqId())in this._calls;);if(f=W(W(W(W(W(W(W({},s?{receive_progress:!0}:{}),a?{disclose_me:!0}:{}),i?{timeout:i}:{}),u?{ppt_scheme:u}:{}),l?{ppt_serializer:l}:{}),h?{ppt_cipher:h}:{}),p?{ppt_keyid:p}:{}),d=t?this._packPPTPayload(t,f):{},E=d.err,y=d.payloadItems,E)throw this._cache.opStatus.error;e.next=22;break;case 22:return this._send([O.WAMP_MSG_SPEC.CALL,_,f,r].concat(I(y||[]))),this._cache.opStatus=W(W({},O.SUCCESS),{},{reqId:_}),this._calls[_]=(0,M.getNewPromise)(),s&&(this._calls[_].onProgress=s),e.abrupt("return",this._calls[_].promise);case 27:case"end":return e.stop()}},e,this)})),function(e,r,t){return s.apply(this,arguments)})},{key:"cancel",value:function(e,r){if(!this._preReqChecks(null,"dealer")||!this._checkRouterFeature("dealer","call_canceling"))throw this._cache.opStatus.error;var t,n;if(!e||!this._calls[e])throw n=new k.NonExistRPCReqIdError,this._fillOpStatusByError(n),n;if(!this._isPlainObject(r)&&void 0!==r)throw n=new k.InvalidParamError("advancedOptions"),this._fillOpStatusByError(n),n;if(this._isPlainObject(r)&&Object.hasOwnProperty.call(r,"mode")){if(!["skip","kill","killnowait"].includes(r.mode))throw n=new k.InvalidParamError("mode"),this._fillOpStatusByError(n),n;t=r.mode}return this._send([O.WAMP_MSG_SPEC.CANCEL,e,{mode:t}]),this._cache.opStatus=W(W({},O.SUCCESS),{},{reqId:e}),!0}},{key:"register",value:(i=L(T().mark(function e(r,t,n){var o,i,s,a;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(o=this._rpcRegs[r])&&null!=(o=o.callbacks)&&o.length)throw o=new k.RPCAlreadyRegisteredError,this._fillOpStatusByError(o),o;e.next=4;break;case 4:if("function"!=typeof t)throw o=new k.NoCallbackError,this._fillOpStatusByError(o),o;e.next=8;break;case 8:if(n&&!this._isPlainObject(n))throw i=new k.InvalidParamError("advancedOptions"),this._fillOpStatusByError(i),i;e.next=12;break;case 12:return i=this._getReqId(),s=(0,M.getNewPromise)(),a=n,t&&(s.rpc=t),this._requests[i]={topic:r,callbacks:s,advancedOptions:n},this._send([O.WAMP_MSG_SPEC.REGISTER,i,a,r]),this._cache.opStatus=W(W({},O.SUCCESS),{},{reqId:i}),e.abrupt("return",s.promise);case 20:case"end":return e.stop()}},e,this)})),function(e,r,t){return i.apply(this,arguments)})},{key:"unregister",value:(o=L(T().mark(function e(r){var t,n;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._preReqChecks({topic:r,patternBased:!1,allowWAMP:!1},"dealer")){e.next=2;break}throw this._cache.opStatus.error;case 2:if(this._rpcRegs[r]){e.next=6;break}throw t=new k.NonExistRPCUnregistrationError,this._fillOpStatusByError(t),t;case 6:return t=this._getReqId(),n=(0,M.getNewPromise)(),this._requests[t]={topic:r,callbacks:n},this._send([O.WAMP_MSG_SPEC.UNREGISTER,t,this._rpcRegs[r].id]),this._cache.opStatus=W(W({},O.SUCCESS),{},{reqId:t}),e.abrupt("return",n.promise);case 12:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})}])&&G(e.prototype,r),n&&G(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),e=t.Wampy=e;t.default=e},{"./constants.js":3,"./errors.js":4,"./serializers/JsonSerializer.js":5,"./utils.js":6}]},{},[2]);
//# sourceMappingURL=wampy.min.js.map
